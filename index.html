<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <style>
    .img-small {
      width: 80%;
      height: auto;
    }

    
  </style>

</head>

<body>
    <div class="jumbotron">
        <h1 class="display-4">Giphy API Search</h1>
        <p class="lead">Homework Assignment 6</p>
        <hr class="my-4">
        
        <p>Type in a search term to add a search button</p>
        
        <label for="queryElement-input">Search Term</label>
        
        <input type="text" id="queryElement-input">
        
        <input id="add-queryElement" type="submit" value="Query Giphy Database">

        <button id="clearInputs">Clear Array</button>
          
      </div>
    <div class="container">
        <h1>Button Holder</h1>
    
        <!-- queryTopic will get dumped here -->
        <div id="buttons-view"></div>
        <form id="queryElement-form">
          
          <br>
    
          <!-- Button triggers new queryElement to be added -->
    
          
        </form>

  <button id="getUser" data-type="users">Get Users</button>
  <button id="getTodo" data-type="todos">Get Todos</button>
  <button id="button2" data-type="button2">Test Button</button>

  <div class="container">
    <div id="outputArea"></div>
  </div>

  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script>

// TEST FUNCTION

function displayqueryElementInfo() {

var queryElement = $(this).attr("data-name");
var queryURL = "https://www.omdbapi.com/?t=" + queryElement + "&apikey=trilogy";

// Creates AJAX call for the specific queryElement button being clicked
$.ajax({
  url: queryURL,
  method: "GET"
}).then(function(response) {
  console.log(response);
  // peterAdvice = response;
  // Creates a div to hold the queryElement
  
  // Retrieves the Rating Data
  // Creates an element to have the rating displayed

  console.log(response.Ratings[0]);
  var ratings = response.Ratings[0];
  $("#queryElementDataDump").append("Rating is " + ratings );

  // Retrieves the release year
  
  console.log(response.Released);
  var released = response.Released;
  // Creates an element to hold the release year

  $("#queryElementDataDump").append("Released " + released );


  // Displays the release year
  // Retrieves the plot

  console.log(response.Plot);
  var plot = response.Plot;

  $("#queryElementDataDump").append("Plot " + plot );


  // Creates an element to hold the plot
  // Appends the plot
  // Creates an element to hold the image
  // Appends the image
  // Puts the entire queryElement above the previous queryElements.
});

}


// TEST FUNCTION ENDS


function clearArrayInputs () {
  $("#buttons-view").empty();
  queryTopic.length = 0;
  queryTopic = [];
}

$("#clearInputs").on("click", function(){
  $("#buttons-view").empty();
  queryTopic.length = 0;
  queryTopic = [];
  clearArrayInputs();
  }

)

// Initial array of chosen topic
var queryTopic = [];

// Function for displaying queryElement data
function renderButtons() {

  // Delete the content inside the buttons-view div prior to adding new queryTopic
  // (this is necessary otherwise you will have repeat buttons)

  $("#buttons-view").empty();


  // Loop through the array of queryTopic, then generate buttons for each element in the array

  for (var i = 0; i < queryTopic.length; i++) { 
  var btn = $("<button>");
  btn.attr("data-name", queryTopic[i]);
  btn.text(queryTopic[i]);
  $("#buttons-view").append(btn);
}
}
// This function handles events where the add queryElement button is clicked
$("#add-queryElement").on("click", function(event) {
  // event.preventDefault() prevents submit button from trying to send a form.
  // Using a submit button instead of a regular button allows the user to hit
  // "Enter" instead of clicking the button if desired
  
  event.preventDefault();

  // Write code to grab the text the user types into the input field

  var queryElement = $("#queryElement-input").val().trim();
  

  // Write code to add the new queryElement into the queryElements array

  queryTopic.push(queryElement);
  console.log(queryTopic);


  // The renderButtons function is called, rendering the list of queryElement buttons
  renderButtons();
  console.log(queryTopic);

  $("#queryElement-input").empty(); 
});

// Calling the renderButtons function to display the initial list of queryTopic
renderButtons();



    var baseUrl = 'https://jsonplaceholder.typicode.com';
    var api_key = "12341234123412341"

    function getInfo(type) {
      console.log(type)

      $.ajax(baseUrl + "/" + type, { method: "GET" })
        .then(function(users) {
          console.log(users);
          genUsers(users)

        })
        .catch(function(err) {
          console.log(err)
        })
    }

    $("#getUser").click(function() {
      console.log(this.dataset.type)
      getInfo(this.dataset.type)
    })

    $("#getTodo").click(function() {
      console.log(this.dataset.type)
      getInfo(this.dataset.type)
    })

    // Secret Sauce 
    // Event will now be registered on dynamically loaded imgs
    $(".container").on("click", ".img-small", function() {
      console.log("clicked");
      console.log($(this))
      console.log($(this).attr("data-gif"))
      console.log($(this).attr("data-toggle"));

      if ($(this).attr("data-toggle") === "false") {
        $(this).attr("src", $(this).attr("data-gif"));
        $(this).attr("data-toggle", true);
      } else {
        $(this).attr("src", $(this).attr("data-still"));
        $(this).attr("data-toggle", false);
      }
    })


    function genUsers(users) {
      for (var i = 0; i < users.length; i++) {
        console.log(users[i]);

        // This sets up the new user div
        var $newUser = $("<div>").addClass("user");
        // we create p tag with a class of user-info, text users loop 54-70
        var $name = $("<p>").addClass("user-info").text(users[i].name);
        var $email = $("<a>").attr("href", users[i].email).text("Email");
        var $image = $("<img>")
          .addClass("img-small")
          .attr("src", "https://images.pexels.com/photos/1556991/pexels-photo-1556991.jpeg?auto=compress&cs=tinysrgb&dpr=3&h=750&w=1260")
          .attr("data-still", "https://images.pexels.com/photos/1556991/pexels-photo-1556991.jpeg?auto=compress&cs=tinysrgb&dpr=3&h=750&w=1260")
          .attr("data-gif", "https://images.pexels.com/photos/1543756/pexels-photo-1543756.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260")
          .attr("data-toggle", false)

        $newUser.append($name, $email, $image);
        $("#outputArea").append($newUser)

      }
    }
  </script>
</body>

</html>